<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>贵金属业务管理层透视</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* 全局样式 */
        :root {
            --main-bg-color: #0A1931;
            --secondary-bg-color: #101f3d;
            --gold-color: #FFD700;
            --gold-alt-color: #B08D57;
            --orange-color: #FF8C00;
            --red-color: #FF4500;
            --blue-color: #4A90E2;
            --light-blue-color: #00BFFF;
            --white-color: #FFFFFF;
            --light-gold: #FFF8E1;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Roboto', 'Noto Sans SC', sans-serif;
        }
        
        body {
            background-color: var(--main-bg-color);
            color: var(--white-color);
            /* 移除overflow: hidden，允许页面滚动 */
            min-height: 100vh;
            position: relative;
        }
        
        /* 添加科技感网格效果 */
        body::before {
            content: '';
            position: fixed; /* 从absolute改为fixed，确保背景固定 */
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                linear-gradient(rgba(74, 144, 226, 0.05) 1px, transparent 1px),
                linear-gradient(90deg, rgba(74, 144, 226, 0.05) 1px, transparent 1px);
            background-size: 20px 20px;
            z-index: -1;
        }
        
        .container {
            padding: 20px;
            width: 100%;
            max-width: 100vw;
            margin: 0 auto;
            /* 确保容器可以自由扩展 */
            height: auto;
            min-height: 100vh;
        }
        
        /* 面包屑导航 */
        .breadcrumb {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            font-size: 1rem;
        }
        
        .breadcrumb-item {
            color: var(--white-color);
            opacity: 0.8;
            text-decoration: none;
            transition: all 0.3s;
        }
        
        .breadcrumb-item:hover {
            opacity: 1;
            text-decoration: underline;
        }
        
        .breadcrumb-separator {
            margin: 0 10px;
            color: var(--light-blue-color);
            opacity: 0.6;
        }
        
        .breadcrumb-current {
            color: var(--gold-color);
            font-weight: bold;
        }
        
        /* 返回按钮样式 */
        .back-button {
            background-color: var(--secondary-bg-color);
            color: var(--gold-color);
            border: 1px solid var(--gold-color);
            border-radius: 4px;
            padding: 5px 10px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 10px;
            text-decoration: none;
            display: inline-block;
        }
        
        .back-button:hover {
            background-color: var(--gold-color);
            color: var(--main-bg-color);
            text-decoration: none;
        }
        
        /* 标题样式 */
        .dashboard-title {
            color: var(--gold-color);
            font-size: 2rem;
            margin-bottom: 30px;
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.3);
        }
        
        /* 指标卡片 */
        .metric-card {
            background-color: var(--secondary-bg-color);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 25px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }
        
        .metric-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(74, 144, 226, 0.3);
        }
        
        .metric-title {
            font-size: 1.3rem;
            color: var(--light-gold);
        }
        
        .metric-value {
            font-size: 1.6rem;
            font-weight: bold;
            color: var(--gold-color);
        }
        
        .metric-change {
            font-size: 0.9rem;
            margin-left: 10px;
        }
        
        .metric-change.positive {
            color: var(--orange-color);
        }
        
        .metric-change.negative {
            color: var(--red-color);
        }
        
        .chart-container {
            height: 280px;
            position: relative;
        }
        
        /* 品种分析栏 */
        .category-section {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 20px;
            margin-top: 30px;
            margin-bottom: 30px; /* 添加底部间距 */
        }
        
        .category-card {
            background-color: var(--secondary-bg-color);
            border-radius: 10px;
            padding: 15px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            transition: transform 0.3s, box-shadow 0.3s;
            cursor: pointer;
            border: 1px solid transparent; /* 添加透明边框，防止hover时元素大小变化 */
        }
        
        .category-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.4);
            border: 1px solid var(--gold-color);
        }
        
        .category-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .category-title {
            font-size: 1.1rem;
            color: var(--light-gold);
        }
        
        .category-value {
            font-size: 1.3rem;
            font-weight: bold;
        }
        
        .platinum {
            color: #C0C0C0;
        }
        
        .gold {
            color: #FFD700;
        }
        
        .silver {
            color: #CDA7E3;
        }
        
        .palladium {
            color: #DAA520;
        }
        
        .other-pt {
            color: #87CEEB;
        }
        
        .category-metrics {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .metric-row {
            display: flex;
            justify-content: space-between;
        }
        
        .metric-label {
            color: var(--white-color);
            opacity: 0.8;
        }
        
        .metric-data {
            font-weight: bold;
        }
        
        /* 动画效果 */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .fade-in {
            animation: fadeIn 0.8s ease-out forwards;
        }
        
        .delay-1 {
            animation-delay: 0.2s;
        }
        
        .delay-2 {
            animation-delay: 0.4s;
        }
        
        .delay-3 {
            animation-delay: 0.6s;
        }
        
        .delay-4 {
            animation-delay: 0.8s;
        }
        
        .delay-5 {
            animation-delay: 1.0s;
        }
        
        /* 响应式调整 */
        @media (max-width: 1200px) {
            .category-section {
                grid-template-columns: repeat(3, 1fr);
            }
        }
        
        @media (max-width: 768px) {
            .category-section {
                grid-template-columns: 1fr;
            }
            
            .metric-header {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .metric-value {
                margin-top: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="breadcrumb">
            <a href="index.html" class="breadcrumb-item">决策驾驶舱</a>
            <span class="breadcrumb-separator">></span>
            <span class="breadcrumb-current" id="metric-name">整体交易额</span>
            <span class="breadcrumb-separator">></span>
            <span class="breadcrumb-current">按品种分析</span>
        </div>
        
        <!-- 将返回按钮移到面包屑下方 -->
        <a href="index.html" class="back-button">← 返回上一级</a>
        
        <h1 class="dashboard-title" id="page-title">整体交易额 - 按品种分析</h1>
        
        <h2 class="dashboard-title" style="font-size: 1.5rem; margin-top: 30px;">贵金属品种明细</h2>
        
        <div class="category-section">
            <div class="category-card fade-in delay-1" onclick="navigateToDetails('platinum')">
                <div class="category-header">
                    <h3 class="category-title">铂金业务</h3>
                    <span class="category-value platinum">102,345</span>
                </div>
                <div class="category-metrics">
                    <div class="metric-row">
                        <span class="metric-label">销售量(千克)</span>
                        <span class="metric-data platinum">1,845</span>
                    </div>
                    <div class="metric-row">
                        <span class="metric-label">同比增长</span>
                        <span class="metric-data platinum">+21.6%</span>
                    </div>
                    <div class="metric-row">
                        <span class="metric-label">毛利率</span>
                        <span class="metric-data platinum">24.8%</span>
                    </div>
                    <!-- 删除了市场占有率行 -->
                </div>
            </div>
            
            <div class="category-card fade-in delay-2" onclick="navigateToDetails('gold')">
                <div class="category-header">
                    <h3 class="category-title">黄金业务</h3>
                    <span class="category-value gold">136,580</span>
                </div>
                <div class="category-metrics">
                    <div class="metric-row">
                        <span class="metric-label">销售量(千克)</span>
                        <span class="metric-data gold">2,630</span>
                    </div>
                    <div class="metric-row">
                        <span class="metric-label">同比增长</span>
                        <span class="metric-data gold">+13.2%</span>
                    </div>
                    <div class="metric-row">
                        <span class="metric-label">毛利率</span>
                        <span class="metric-data gold">18.6%</span>
                    </div>
                    <!-- 删除了市场占有率行 -->
                </div>
            </div>
            
            <div class="category-card fade-in delay-3" onclick="navigateToDetails('silver')">
                <div class="category-header">
                    <h3 class="category-title">白银业务</h3>
                    <span class="category-value silver">48,710</span>
                </div>
                <div class="category-metrics">
                    <div class="metric-row">
                        <span class="metric-label">销售量(千克)</span>
                        <span class="metric-data silver">1,167</span>
                    </div>
                    <div class="metric-row">
                        <span class="metric-label">同比增长</span>
                        <span class="metric-data silver">+9.7%</span>
                    </div>
                    <div class="metric-row">
                        <span class="metric-label">毛利率</span>
                        <span class="metric-data silver">22.1%</span>
                    </div>
                    <!-- 删除了市场占有率行 -->
                </div>
            </div>
            
            <div class="category-card fade-in delay-4" onclick="navigateToDetails('palladium')">
                <div class="category-header">
                    <h3 class="category-title">钯金业务</h3>
                    <span class="category-value palladium">78,420</span>
                </div>
                <div class="category-metrics">
                    <div class="metric-row">
                        <span class="metric-label">销售量(千克)</span>
                        <span class="metric-data palladium">1,325</span>
                    </div>
                    <div class="metric-row">
                        <span class="metric-label">同比增长</span>
                        <span class="metric-data palladium">+18.4%</span>
                    </div>
                    <div class="metric-row">
                        <span class="metric-label">毛利率</span>
                        <span class="metric-data palladium">26.3%</span>
                    </div>
                </div>
            </div>
            
            <div class="category-card fade-in delay-5" onclick="navigateToDetails('other-pt')">
                <div class="category-header">
                    <h3 class="category-title">其他铂族金属业务</h3>
                    <span class="category-value other-pt">35,680</span>
                </div>
                <div class="category-metrics">
                    <div class="metric-row">
                        <span class="metric-label">销售量(千克)</span>
                        <span class="metric-data other-pt">842</span>
                    </div>
                    <div class="metric-row">
                        <span class="metric-label">同比增长</span>
                        <span class="metric-data other-pt">+15.7%</span>
                    </div>
                    <div class="metric-row">
                        <span class="metric-label">毛利率</span>
                        <span class="metric-data other-pt">23.1%</span>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="metric-card fade-in">
            <div class="metric-header">
                <h2 class="metric-title" id="main-metric-title">整体交易总量趋势分析</h2>
                <div>
                    <span class="metric-value" id="main-metric-value">287,635</span>
                    <span class="metric-unit">万元</span>
                    <span class="metric-change positive">
                        <i>▲</i> 同比 +15.3%
                    </span>
                </div>
            </div>
            <div class="chart-container">
                <canvas id="mainChart"></canvas>
            </div>
        </div>
        
        <div class="metric-card fade-in delay-1">
            <div class="metric-header">
                <h2 class="metric-title">品种月度交易额趋势分析</h2>
            </div>
            <div class="chart-container">
                <canvas id="trendChart"></canvas>
            </div>
        </div>
    </div>
    
    <script>
        // 获取URL参数
        function getUrlParam(param) {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(param);
        }
        
        // 页面导航函数
        function navigateToDetails(metal) {
            const metric = getUrlParam('metric') || 'transaction';
            window.location.href = `details.html?metric=${metric}&metal=${metal}`;
        }
        
        // 初始化图表
        function initCharts() {
            const metric = getUrlParam('metric') || 'transaction';
            let metricName, metricValue, metricUnit, chartData;
            
            // 根据指标设置相应的数据
            switch(metric) {
                case 'transaction':
                    metricName = '整体交易额';
                    metricValue = '287,635';
                    metricUnit = '万元';
                    chartData = {
                        labels: ['铂金', '黄金', '白银', '钯金', '其他铂族金属'],
                        values: [102345, 136580, 48710, 78420, 35680],
                        colors: ['#C0C0C0', '#FFD700', '#CDA7E3', '#DAA520', '#87CEEB'],
                        trendLabels: ['1月', '2月', '3月', '4月', '5月', '6月', '7月', '8月', '9月', '10月', '11月', '12月'],
                        trendValues: [
                            [15200, 18500, 16300, 21000, 17800, 19500, 18200, 22000, 18900, 23000, 20100, 19800], // 铂金
                            [21500, 23400, 21800, 26000, 24300, 22500, 24100, 27500, 24800, 28500, 26300, 25900], // 黄金
                            [7600, 7900, 8300, 9200, 8500, 7800, 8700, 9500, 8800, 10200, 9300, 9200],  // 白银
                            [12800, 14100, 13500, 16500, 14800, 15200, 15100, 18500, 15400, 19200, 16700, 16300], // 钯金
                            [5900, 6500, 6100, 7800, 6800, 7200, 6900, 8200, 6950, 8900, 7500, 7400]  // 其他铂族金属
                        ]
                    };
                    break;
                case 'volume':
                    metricName = '贵金属交易量';
                    metricValue = '5,642';
                    metricUnit = '千克';
                    chartData = {
                        labels: ['铂金', '黄金', '白银', '钯金', '其他铂族金属'],
                        values: [1845, 2630, 1167, 1325, 842],
                        colors: ['#C0C0C0', '#FFD700', '#CDA7E3', '#DAA520', '#87CEEB'],
                        trendLabels: ['1月', '2月', '3月', '4月', '5月', '6月', '7月', '8月', '9月', '10月', '11月', '12月'],
                        trendValues: [
                            [280, 325, 310, 380, 320, 350, 330, 390, 335, 410, 360, 355], // 铂金
                            [410, 450, 430, 520, 470, 480, 480, 550, 485, 580, 510, 505], // 黄金
                            [180, 185, 200, 250, 205, 220, 210, 260, 212, 280, 225, 222],  // 白银
                            [220, 245, 230, 310, 250, 280, 255, 320, 258, 340, 270, 268], // 钯金
                            [150, 165, 155, 210, 170, 190, 175, 220, 178, 240, 190, 188]  // 其他铂族金属
                        ]
                    };
                    break;
                case 'market_share':
                    metricName = '市场占有率';
                    metricValue = '32.6%';
                    metricUnit = '';
                    chartData = {
                        labels: ['铂金', '黄金', '白银', '钯金', '其他铂族金属'],
                        values: [32.6, 27.3, 19.8, 24.5, 18.7],
                        colors: ['#C0C0C0', '#FFD700', '#CDA7E3', '#DAA520', '#87CEEB'],
                        trendLabels: ['1月', '2月', '3月', '4月', '5月', '6月', '7月', '8月', '9月', '10月', '11月', '12月'],
                        trendValues: [
                            [33.2, 32.8, 32.7, 34.2, 32.6, 33.5, 32.7, 35.2, 32.7, 36.1, 32.9, 32.8], // 铂金
                            [27.0, 27.3, 27.2, 28.5, 27.3, 27.8, 27.4, 29.2, 27.4, 30.1, 27.6, 27.5], // 黄金
                            [19.5, 19.6, 19.8, 20.5, 19.7, 20.2, 19.9, 21.2, 19.9, 22.1, 20.1, 20.0],  // 白银
                            [24.0, 24.2, 24.1, 25.8, 24.3, 25.2, 24.3, 26.5, 24.3, 27.2, 24.5, 24.4], // 钯金
                            [18.5, 18.7, 18.6, 19.8, 18.8, 19.2, 18.8, 20.5, 18.8, 21.2, 19.0, 18.9]  // 其他铂族金属
                        ]
                    };
                    break;
                case 'profit':
                    metricName = '毛利润达成率';
                    metricValue = '91.2%';
                    metricUnit = '';
                    chartData = {
                        labels: ['铂金', '黄金', '白银', '钯金', '其他铂族金属'],
                        values: [98.2, 83.5, 92.0, 95.3, 89.7],
                        colors: ['#C0C0C0', '#FFD700', '#CDA7E3', '#DAA520', '#87CEEB'],
                        trendLabels: ['1月', '2月', '3月', '4月', '5月', '6月', '7月', '8月', '9月', '10月', '11月', '12月'],
                        trendValues: [
                            [96.5, 97.5, 98.0, 99.5, 98.2, 99.8, 98.3, 100.2, 98.3, 101.5, 98.5, 98.4], // 铂金
                            [88.0, 86.0, 85.0, 87.5, 84.0, 86.2, 83.6, 88.5, 83.6, 89.2, 83.8, 83.7], // 黄金
                            [90.5, 91.5, 92.0, 93.5, 92.0, 93.2, 92.1, 94.2, 92.1, 95.5, 92.3, 92.2],  // 白银
                            [94.0, 94.5, 94.8, 96.2, 95.0, 96.5, 95.4, 97.2, 95.4, 98.5, 95.6, 95.5], // 钯金
                            [88.5, 89.0, 89.2, 90.8, 89.5, 90.2, 89.8, 91.5, 89.8, 92.2, 90.0, 89.9]  // 其他铂族金属
                        ]
                    };
                    break;
                default:
                    metricName = '整体交易额';
                    metricValue = '287,635';
                    metricUnit = '万元';
                    chartData = {
                        labels: ['铂金', '黄金', '白银', '钯金', '其他铂族金属'],
                        values: [102345, 136580, 48710, 78420, 35680],
                        colors: ['#C0C0C0', '#FFD700', '#CDA7E3', '#DAA520', '#87CEEB'],
                        trendLabels: ['1月', '2月', '3月', '4月', '5月', '6月', '7月', '8月', '9月', '10月', '11月', '12月'],
                        trendValues: [
                            [15200, 18500, 16300, 21000, 17800, 19500, 18200, 22000, 18900, 23000, 20100, 19800], // 铂金
                            [21500, 23400, 21800, 26000, 24300, 22500, 24100, 27500, 24800, 28500, 26300, 25900], // 黄金
                            [7600, 7900, 8300, 9200, 8500, 7800, 8700, 9500, 8800, 10200, 9300, 9200],  // 白银
                            [12800, 14100, 13500, 16500, 14800, 15200, 15100, 18500, 15400, 19200, 16700, 16300], // 钯金
                            [5900, 6500, 6100, 7800, 6800, 7200, 6900, 8200, 6950, 8900, 7500, 7400]  // 其他铂族金属
                        ]
                    };
            }
            
            // 更新页面文本内容
            document.getElementById('metric-name').textContent = metricName;
            document.getElementById('page-title').textContent = `${metricName} - 按品种分析`;
            document.getElementById('main-metric-title').textContent = `${metricName}分析`;
            document.getElementById('main-metric-value').textContent = metricValue;
            
            // 主图表 - 堆叠柱状图
            const mainChartCtx = document.getElementById('mainChart').getContext('2d');
            const mainChart = new Chart(mainChartCtx, {
                type: 'bar',
                data: {
                    labels: chartData.labels,
                    datasets: [{
                        label: metricName,
                        data: chartData.values,
                        backgroundColor: chartData.colors,
                        borderColor: 'rgba(10, 25, 49, 0.2)',
                        borderWidth: 1,
                        barPercentage: 0.6
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            grid: {
                                color: 'rgba(74, 144, 226, 0.1)'
                            },
                            ticks: {
                                color: '#FFF8E1'
                            }
                        },
                        y: {
                            grid: {
                                color: 'rgba(74, 144, 226, 0.1)'
                            },
                            ticks: {
                                color: '#FFF8E1'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    let label = context.dataset.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    if (context.parsed.y !== null) {
                                        label += context.parsed.y.toLocaleString() + (metricUnit || '');
                                    }
                                    return label;
                                }
                            }
                        }
                    }
                }
            });
            
            // 趋势图表 - 折线图（增强交互效果）
            const trendChartCtx = document.getElementById('trendChart').getContext('2d');
            const trendChart = new Chart(trendChartCtx, {
                type: 'line',
                data: {
                    labels: chartData.trendLabels,
                    datasets: [{
                        label: '铂金',
                        data: chartData.trendValues[0],
                        borderColor: '#C0C0C0',
                        backgroundColor: 'rgba(192, 192, 192, 0.1)',
                        borderWidth: 2,
                        fill: false,
                        tension: 0.4,
                        pointRadius: 4,
                        pointHoverRadius: 6
                    }, {
                        label: '黄金',
                        data: chartData.trendValues[1],
                        borderColor: '#FFD700',
                        backgroundColor: 'rgba(255, 215, 0, 0.1)',
                        borderWidth: 2,
                        fill: false,
                        tension: 0.4,
                        pointRadius: 4,
                        pointHoverRadius: 6
                    }, {
                        label: '白银',
                        data: chartData.trendValues[2],
                        borderColor: '#CDA7E3',
                        backgroundColor: 'rgba(205, 167, 227, 0.1)',
                        borderWidth: 2,
                        fill: false,
                        tension: 0.4,
                        pointRadius: 4,
                        pointHoverRadius: 6
                    }, {
                        label: '钯金',
                        data: chartData.trendValues[3],
                        borderColor: '#DAA520',
                        backgroundColor: 'rgba(218, 165, 32, 0.1)',
                        borderWidth: 2,
                        fill: false,
                        tension: 0.4,
                        pointRadius: 4,
                        pointHoverRadius: 6
                    }, {
                        label: '其他铂族金属',
                        data: chartData.trendValues[4],
                        borderColor: '#87CEEB',
                        backgroundColor: 'rgba(135, 206, 235, 0.1)',
                        borderWidth: 2,
                        fill: false,
                        tension: 0.4,
                        pointRadius: 4,
                        pointHoverRadius: 6
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: {
                        mode: 'index',
                        intersect: false
                    },
                    scales: {
                        x: {
                            grid: {
                                color: 'rgba(74, 144, 226, 0.1)'
                            },
                            ticks: {
                                color: '#FFF8E1'
                            }
                        },
                        y: {
                            grid: {
                                color: 'rgba(74, 144, 226, 0.1)'
                            },
                            ticks: {
                                color: '#FFF8E1'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            position: 'top',
                            labels: {
                                color: '#FFF8E1'
                            }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(16, 31, 61, 0.9)',
                            titleColor: '#FFF8E1',
                            bodyColor: '#FFF8E1',
                            borderColor: 'rgba(74, 144, 226, 0.5)',
                            borderWidth: 1,
                            cornerRadius: 8,
                            displayColors: true,
                            callbacks: {
                                title: function(tooltipItems) {
                                    return tooltipItems[0].label + ' 交易额详情';
                                },
                                label: function(context) {
                                    let label = context.dataset.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    if (context.parsed.y !== null) {
                                        label += context.parsed.y.toLocaleString() + (metricUnit || '万元');
                                    }
                                    return label;
                                },
                                afterBody: function(tooltipItems) {
                                    // 计算当月总交易额
                                    let total = 0;
                                    tooltipItems.forEach(item => {
                                        total += item.parsed.y;
                                    });
                                    return ['当月总计: ' + total.toLocaleString() + (metricUnit || '万元')];
                                }
                            }
                        }
                    }
                }
            });
        }
        
        // 页面加载完成后执行
        document.addEventListener('DOMContentLoaded', () => {
            initCharts();
        });
    </script>
</body>
</html>
